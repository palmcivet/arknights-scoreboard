import{d as u,f,g as d,h as l,r as g,m as v,a as s,e as m,ap as J,o as c,c as S,aq as U,b as y,n as _,ar as K,j as i,as as M,at as G,au as W,av as Q,S as j,aw as X,z as D,A as q,ax as Z,O as w,ay as Y,az as ee,aA as se,aB as te,aC as ae,aD as oe,s as h,aE as re,aF as ne,aG as ce,aH as le,aI as ie,q as k,x as C,t as x,aJ as de,ac as ue,ad as me,a0 as z,af as pe,aK as fe,aL as ge,aM as he,aN as _e,aO as ye,F as N,l as V,aP as be}from"./index-B_Xfg7SQ.js";const ls=u({__name:"ToastAction",props:{altText:{},asChild:{type:Boolean},as:{},class:{}},setup(e){const t=e,a=f(()=>{const{class:o,...n}=t;return n});return(o,n)=>(c(),d(s(J),v(a.value,{class:s(m)("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t.class)}),{default:l(()=>[g(o.$slots,"default")]),_:3},16,["class"]))}});/**
 * @license lucide-vue-next v0.451.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=S("CheckIcon",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-vue-next v0.451.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=S("ChevronDownIcon",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-vue-next v0.451.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=S("ChevronUpIcon",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-vue-next v0.451.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=S("MinusIcon",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-vue-next v0.451.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=S("PlusIcon",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),F=U("events",{state:()=>({rulesJSON:{},rulesURL:null,challenger:null,starting:null,begin:Date.now(),end:Date.now(),isPlaying:!1,isPaused:!1})}),we={id:"Player",avatar:"",description:""},Se={squad:"",pickup:[],remark:""},$=U("records",{state:()=>({rulesForm:[],rulesSet:{},records:{}}),getters:{score(e){return Object.values(e.records).reduce((t,a)=>t+a.score,0)},details(e){return Object.values(e.records).filter(t=>t.score!==0).map(t=>({...t,label:e.rulesSet[t.id].label}))}}});var I=(e=>(e.CHECK="check",e.COUNT="count",e.INPUT="input",e.SELECT="select",e.GROUP="group",e))(I||{});function ke(e){return!!e.id}function A(e,t,a){for(let o=0;o<e.length;o++){const n=t?`${t}.${o}`:`${o}`,r=e[o];r.type===I.SELECT&&(r.options.some(b=>b.score===0)||r.options.unshift({label:"未选择",score:0})),r.type===I.GROUP?A(r.children,n,a):ke(r)?a[r.id]=r:(r.id=n,a[n]={...r,id:n})}}function Ce(e){const t=e,a={};return A(t,"",a),{rulesForm:t,rulesSet:a}}function is(e){const t=F();t.rulesJSON=e;const a=$();a.$reset();const{rulesForm:o,rulesSet:n}=Ce(e.items);a.rulesForm=o,a.rulesSet=n}function ds(e){const t=F();t.challenger=e.challenger??t.challenger,t.starting=e.starting??t.starting}function us(){const e=F(),t=$();if(e.challenger===null)throw new Error("[AKS] Challenger is not set");return{rules:e.rulesJSON.name,rulesVersion:e.rulesJSON.version,challenger:e.challenger??we,starting:e.starting??Se,begin:e.begin,end:e.end,score:t.score,items:Object.entries(t.records).map(([a,o])=>({...o,id:a}))}}function ms(){const e=$();e.records={}}function B(e){const t=$();t.records[e.id]=e}const Be=u({__name:"Card",props:{class:{}},setup(e){const t=e;return(a,o)=>(c(),y("div",{class:_(s(m)("rounded-lg border bg-card text-card-foreground shadow-sm",t.class))},[g(a.$slots,"default")],2))}}),Pe=u({__name:"CardHeader",props:{class:{}},setup(e){const t=e;return(a,o)=>(c(),y("div",{class:_(s(m)("flex flex-col gap-y-1.5 p-6",t.class))},[g(a.$slots,"default")],2))}}),Oe=u({__name:"CardTitle",props:{class:{}},setup(e){const t=e;return(a,o)=>(c(),y("h3",{class:_(s(m)("text-2xl font-semibold leading-none tracking-tight",t.class))},[g(a.$slots,"default")],2))}}),je=u({__name:"CardDescription",props:{class:{}},setup(e){const t=e;return(a,o)=>(c(),y("p",{class:_(s(m)("text-sm text-muted-foreground",t.class))},[g(a.$slots,"default")],2))}}),Ne=u({__name:"CardContent",props:{class:{}},setup(e){const t=e;return(a,o)=>(c(),y("div",{class:_(s(m)("p-6 pt-0",t.class))},[g(a.$slots,"default")],2))}}),Ve=u({__name:"ScrollBar",props:{orientation:{default:"vertical"},forceMount:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(e){const t=e,a=f(()=>{const{class:o,...n}=t;return n});return(o,n)=>(c(),d(s(K),v(a.value,{class:s(m)("flex touch-none select-none transition-colors",o.orientation==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-px",o.orientation==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-px",t.class)}),{default:l(()=>[i(s(M),{class:"relative flex-1 rounded-full bg-border"})]),_:1},16,["class"]))}}),ps=u({__name:"ScrollArea",props:{type:{},dir:{},scrollHideDelay:{},asChild:{type:Boolean},as:{},class:{}},setup(e){const t=e,a=f(()=>{const{class:o,...n}=t;return n});return(o,n)=>(c(),d(s(G),v(a.value,{class:s(m)("relative overflow-hidden",t.class)}),{default:l(()=>[i(s(W),{class:"h-full w-full rounded-[inherit]"},{default:l(()=>[g(o.$slots,"default")]),_:3}),i(Ve),i(s(Q))]),_:3},16,["class"]))}}),Fe=u({__name:"Select",props:{open:{type:Boolean},defaultOpen:{type:Boolean},defaultValue:{},modelValue:{},dir:{},name:{},autocomplete:{},disabled:{type:Boolean},required:{type:Boolean}},emits:["update:modelValue","update:open"],setup(e,{emit:t}){const n=j(e,t);return(r,p)=>(c(),d(s(X),D(q(s(n))),{default:l(()=>[g(r.$slots,"default")]),_:3},16))}}),Ue=u({__name:"SelectValue",props:{placeholder:{},asChild:{type:Boolean},as:{}},setup(e){const t=e;return(a,o)=>(c(),d(s(Z),D(q(t)),{default:l(()=>[g(a.$slots,"default")]),_:3},16))}}),De=u({__name:"SelectTrigger",props:{disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(e){const t=e,a=f(()=>{const{class:n,...r}=t;return r}),o=w(a);return(n,r)=>(c(),d(s(Y),v(s(o),{class:s(m)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:truncate text-start",t.class)}),{default:l(()=>[g(n.$slots,"default"),i(s(ee),{"as-child":""},{default:l(()=>[i(s(L),{class:"w-4 h-4 opacity-50 shrink-0"})]),_:1})]),_:3},16,["class"]))}}),qe=u({inheritAttrs:!1,__name:"SelectContent",props:{forceMount:{type:Boolean},position:{default:"popper"},bodyLock:{type:Boolean},side:{},sideOffset:{},align:{},alignOffset:{},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean},updatePositionStrategy:{},prioritizePosition:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["closeAutoFocus","escapeKeyDown","pointerDownOutside"],setup(e,{emit:t}){const a=e,o=t,n=f(()=>{const{class:p,...b}=a;return b}),r=j(n,o);return(p,b)=>(c(),d(s(se),null,{default:l(()=>[i(s(te),v({...s(r),...p.$attrs},{class:s(m)("relative z-50 max-h-96 min-w-32 overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",p.position==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a.class)}),{default:l(()=>[i(s(Ae)),i(s(ae),{class:_(s(m)("p-1",p.position==="popper"&&"h-[--radix-select-trigger-height] w-full min-w-[--radix-select-trigger-width]"))},{default:l(()=>[g(p.$slots,"default")]),_:3},8,["class"]),i(s(Ee))]),_:3},16,["class"])]),_:3}))}}),ze={class:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center"},Le=u({__name:"SelectItem",props:{value:{},disabled:{type:Boolean},textValue:{},asChild:{type:Boolean},as:{},class:{}},setup(e){const t=e,a=f(()=>{const{class:n,...r}=t;return r}),o=w(a);return(n,r)=>(c(),d(s(oe),v(s(o),{class:s(m)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t.class)}),{default:l(()=>[h("span",ze,[i(s(re),null,{default:l(()=>[i(s(ve),{class:"h-4 w-4"})]),_:1})]),i(s(ne),null,{default:l(()=>[g(n.$slots,"default")]),_:3})]),_:3},16,["class"]))}}),Ae=u({__name:"SelectScrollUpButton",props:{asChild:{type:Boolean},as:{},class:{}},setup(e){const t=e,a=f(()=>{const{class:n,...r}=t;return r}),o=w(a);return(n,r)=>(c(),d(s(ce),v(s(o),{class:s(m)("flex cursor-default items-center justify-center py-1",t.class)}),{default:l(()=>[g(n.$slots,"default",{},()=>[i(s(xe),{class:"h-4 w-4"})])]),_:3},16,["class"]))}}),Ee=u({__name:"SelectScrollDownButton",props:{asChild:{type:Boolean},as:{},class:{}},setup(e){const t=e,a=f(()=>{const{class:n,...r}=t;return r}),o=w(a);return(n,r)=>(c(),d(s(le),v(s(o),{class:s(m)("flex cursor-default items-center justify-center py-1",t.class)}),{default:l(()=>[g(n.$slots,"default",{},()=>[i(s(L),{class:"h-4 w-4"})])]),_:3},16,["class"]))}}),Te={class:"mb-2 flex items-center justify-between"},He={class:"flex w-full flex-1 items-center truncate"},P=u({name:"ScoringItemSlot",__name:"item-slot",props:{scoringItem:{type:Object,required:!0},score:{type:Number,default:0}},setup(e){const t=ie();return(a,o)=>(c(),y("div",{class:_(s(m)("scoring-item-slot flex flex-col justify-between",a.$attrs.class??""))},[h("div",Te,[h("div",He,[i(s(de),{class:"truncate text-sm"},{default:l(()=>[C(x(e.scoringItem.label),1)]),_:1}),e.scoringItem.description?(c(),d(s(ue),{key:0},{default:l(()=>[i(s(me),null,{default:l(()=>[i(s(z),{class:"mx-1 size-4",icon:"mdi:information-slab-circle-outline"})]),_:1}),i(s(pe),null,{default:l(()=>[h("span",null,x(e.scoringItem.description),1)]),_:1})]),_:1})):k("",!0)]),s(t).showScoreDetail?(c(),y("span",{key:0,class:_(s(m)("text-xs",e.score>0?"text-foreground":"text-muted-foreground"))},x(e.score)+" 分 ",3)):k("",!0)]),g(a.$slots,"default")],2))}}),Re={class:"flex items-center justify-between"},Je={class:"flex items-center text-sm"},Ke={class:"w-8 text-right"},Me=u({name:"ScoringItemCheck",__name:"item-check",props:{scoringItem:{type:Object,required:!0}},setup(e){const t=$(),a=f(()=>t.records[e.scoringItem.id]??{score:0,check:!1}),o=f(()=>a.value.check),n=r=>{B({id:e.scoringItem.id,score:r?e.scoringItem.score:0,check:r})};return(r,p)=>(c(),d(P,{class:_(s(m)("scoring-item-check",r.$attrs.class??"")),"scoring-item":e.scoringItem,score:a.value.score},{default:l(()=>[h("div",Re,[h("div",Je,[h("span",Ke,x(e.scoringItem.score),1),p[0]||(p[0]=h("span",{class:"ml-1"},"分",-1))]),i(s(fe),{checked:o.value,"onUpdate:checked":n},null,8,["checked"])])]),_:1},8,["class","scoring-item","score"]))}}),E=u({__name:"NumberField",props:{defaultValue:{},modelValue:{},min:{},max:{},step:{},formatOptions:{},locale:{},disabled:{type:Boolean},required:{type:Boolean},name:{},id:{},asChild:{type:Boolean},as:{},class:{}},emits:["update:modelValue"],setup(e,{emit:t}){const a=e,o=t,n=f(()=>{const{class:p,...b}=a;return b}),r=j(n,o);return(p,b)=>(c(),d(s(ge),v(s(r),{class:s(m)("grid gap-1.5",a.class)}),{default:l(()=>[g(p.$slots,"default")]),_:3},16,["class"]))}}),T=u({__name:"NumberFieldInput",props:{class:{}},setup(e){const t=e;return(a,o)=>(c(),d(s(he),{"data-slot":"input",class:_(s(m)("flex h-10 w-full rounded-md border border-input bg-background py-2 text-sm text-center ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t.class))},null,8,["class"]))}}),Ge=u({__name:"NumberFieldIncrement",props:{disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(e){const t=e,a=f(()=>{const{class:n,...r}=t;return r}),o=w(a);return(n,r)=>(c(),d(s(_e),v({"data-slot":"increment"},s(o),{class:s(m)("absolute top-1/2 -translate-y-1/2 right-0 disabled:cursor-not-allowed disabled:opacity-20 p-3",t.class)}),{default:l(()=>[g(n.$slots,"default",{},()=>[i(s(Ie),{class:"h-4 w-4"})])]),_:3},16,["class"]))}}),We=u({__name:"NumberFieldDecrement",props:{disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(e){const t=e,a=f(()=>{const{class:n,...r}=t;return r}),o=w(a);return(n,r)=>(c(),d(s(ye),v({"data-slot":"decrement"},s(o),{class:s(m)("absolute top-1/2 -translate-y-1/2 left-0 p-3 disabled:cursor-not-allowed disabled:opacity-20",t.class)}),{default:l(()=>[g(n.$slots,"default",{},()=>[i(s($e),{class:"h-4 w-4"})])]),_:3},16,["class"]))}}),H=u({__name:"NumberFieldContent",props:{class:{}},setup(e){const t=e;return(a,o)=>(c(),y("div",{class:_(s(m)("relative [&>[data-slot=input]]:has-[[data-slot=increment]]:pr-5 [&>[data-slot=input]]:has-[[data-slot=decrement]]:pl-5",t.class))},[g(a.$slots,"default")],2))}}),Qe={class:"flex items-center justify-between gap-xs"},Xe={class:"flex items-center text-sm"},Ze={class:"w-8 text-right"},Ye=u({name:"ScoringItemCount",__name:"item-count",props:{scoringItem:{type:Object,required:!0}},setup(e){const t=$(),a=f(()=>t.records[e.scoringItem.id]??{score:0,count:0}),o=f(()=>a.value.count),n=r=>{B({id:e.scoringItem.id,score:r*e.scoringItem.score,count:r})};return(r,p)=>(c(),d(P,{class:_(s(m)("scoring-item-count",r.$attrs.class??"")),"scoring-item":e.scoringItem,score:a.value.score},{default:l(()=>[h("div",Qe,[h("div",Xe,[h("span",Ze,x(e.scoringItem.score),1),p[0]||(p[0]=h("span",{class:"ml-1"},"分",-1))]),i(s(E),{class:"max-w-[160px] flex-1","model-value":o.value,min:0,"onUpdate:modelValue":n},{default:l(()=>[i(s(H),null,{default:l(()=>[i(s(We)),i(s(T)),i(s(Ge))]),_:1})]),_:1},8,["model-value"])])]),_:1},8,["class","scoring-item","score"]))}}),es=u({name:"ScoringItemSelect",__name:"item-select",props:{scoringItem:{type:Object,required:!0}},setup(e){const t=$(),a=f(()=>t.records[e.scoringItem.id]??{score:0,select:"0"}),o=f(()=>a.value.select),n=r=>{const p=Number.parseInt(r),b=Number.isNaN(p)?0:p,O=e.scoringItem.options[b].score;B({id:e.scoringItem.id,select:r,score:O})};return(r,p)=>(c(),d(P,{class:_(s(m)("scoring-item-group",r.$attrs.class??"")),"scoring-item":e.scoringItem,score:a.value.score},{default:l(()=>[i(s(Fe),{"default-value":o.value,"model-value":o.value,"onUpdate:modelValue":n},{default:l(()=>[i(s(De),{class:"flex-1 truncate"},{default:l(()=>[i(s(Ue),{placeholder:e.scoringItem.label},null,8,["placeholder"])]),_:1}),i(s(qe),null,{default:l(()=>[(c(!0),y(N,null,V(e.scoringItem.options,(b,O)=>(c(),d(s(Le),{value:`${O}`},{default:l(()=>[C(x(b.label)+" （"+x(b.score)+"） ",1)]),_:2},1032,["value"]))),256))]),_:1})]),_:1},8,["default-value","model-value"])]),_:1},8,["class","scoring-item","score"]))}}),ss={class:"flex items-center justify-between gap-xs"},ts={class:"flex items-center text-sm"},as={class:"w-8 text-right"},os=u({name:"ScoringItemInput",__name:"item-input",props:{scoringItem:{type:Object,required:!0}},setup(e){const t=$(),a=f(()=>t.records[e.scoringItem.id]??{score:0,input:0}),o=f(()=>a.value.input),n=r=>{B({id:e.scoringItem.id,score:r*e.scoringItem.score,input:r})};return(r,p)=>(c(),d(P,{class:_(s(m)("scoring-item-group",r.$attrs.class??"")),"scoring-item":e.scoringItem,score:a.value.score},{default:l(()=>[h("div",ss,[h("div",ts,[h("span",as,x(o.value),1),p[0]||(p[0]=h("span",{class:"ml-1"},"分",-1))]),i(s(E),{class:"max-w-[160px] flex-1",step:.01,"model-value":o.value,"onUpdate:modelValue":n},{default:l(()=>[i(s(H),null,{default:l(()=>[i(s(T))]),_:1})]),_:1},8,["model-value"])])]),_:1},8,["class","scoring-item","score"]))}}),R=u({name:"ScoringItem",__name:"component",props:{scoringItem:{type:Object,required:!0},level:{type:Number,default:0}},setup(e){return(t,a)=>e.scoringItem.type===s(I).CHECK?(c(),d(Me,{key:0,"scoring-item":e.scoringItem},null,8,["scoring-item"])):e.scoringItem.type===s(I).COUNT?(c(),d(Ye,{key:1,"scoring-item":e.scoringItem},null,8,["scoring-item"])):e.scoringItem.type===s(I).INPUT?(c(),d(os,{key:2,"scoring-item":e.scoringItem},null,8,["scoring-item"])):e.scoringItem.type===s(I).SELECT?(c(),d(es,{key:3,"scoring-item":e.scoringItem},null,8,["scoring-item"])):e.scoringItem.type===s(I).GROUP?(c(),d(rs,{key:4,"scoring-item":e.scoringItem,level:e.level+1},null,8,["scoring-item","level"])):k("",!0)}}),rs=u({name:"ScoringItemGroup",__name:"item-group",props:{scoringItem:{type:Object,required:!0},level:{type:Number,default:0}},setup(e){return(t,a)=>(c(),d(s(Be),{class:_(s(m)("scoring-item-group",t.$attrs.class??""))},{default:l(()=>[i(s(Pe),{class:"p-xs md:p-sm"},{default:l(()=>[i(s(Oe),{class:"text-xl"},{default:l(()=>[C(x(e.scoringItem.label),1)]),_:1}),e.scoringItem.description?(c(),d(s(je),{key:0},{default:l(()=>[C(x(e.scoringItem.description),1)]),_:1})):k("",!0)]),_:1}),i(s(Ne),{class:"flex columns-2 flex-col gap-sm p-xs pt-0 md:p-sm md:pt-0"},{default:l(()=>[(c(!0),y(N,null,V(e.scoringItem.children,o=>(c(),d(R,{"scoring-item":o},null,8,["scoring-item"]))),256))]),_:1})]),_:1},8,["class"]))}}),ns={key:0,class:"flex h-[80vh] w-full items-center justify-center text-gray-500"},fs=u({name:"ScoringCards",__name:"component",setup(e){const t=$();return(a,o)=>s(t).rulesForm.length?(c(),y("div",{key:1,class:_(s(m)("scoring-cards md:columns-3 md:py-sm lg:py-md xl:columns-4",a.$attrs.class??""))},[(c(!0),y(N,null,V(s(t).rulesForm,(n,r)=>(c(),d(s(R),{key:n.label+r,style:be(`animation-delay: ${r*50}ms`),class:_(["break-inside-avoid-column","motion-safe:animate-fade-in-up opacity-0 transition-all sm:[&+&]:mt-xs md:[&+&]:mt-sm"]),"scoring-item":n},null,8,["style","scoring-item"]))),128))],2)):(c(),y("div",ns,[i(s(z),{class:"size-5",icon:"mdi:card-bulleted-outline"}),o[0]||(o[0]=h("span",{class:"ml-2 text-sm"},"未加载赛事规则",-1))]))}});export{Se as D,Be as _,Pe as a,Oe as b,Ne as c,Fe as d,De as e,Ue as f,qe as g,ls as h,Le as i,is as j,ds as k,$ as l,ps as m,ms as n,us as o,fs as p,F as u};
